%Modulation order and target code rate determination

function [Qm,R,SE]=MCS_index_table(I_MCS,PDSCH_Config)
% global I_MCS
% global MCS_Table_PDSCH

% global PDSCH_Config 

I_MCS_Table1=[0	2	120	  0.2344
1	2	157	  0.3066
2	2	193	  0.3770
3	2	251	  0.4902
4	2	308	  0.6016
5	2	379	  0.7402
6	2	449	  0.8770
7	2	526	  1.0273
8	2	602	  1.1758
9	2	679	  1.3262
10	4	340	  1.3281
11	4	378	  1.4766
12	4	434	  1.6953
13	4	490	  1.9141
14	4	553	  2.1602
15	4	616	  2.4063
16	4	658	  2.5703
17	6	438	  2.5664
18	6	466	  2.7305
19	6	517	  3.0293
20	6	567	  3.3223
21	6	616	  3.6094
22	6	666	  3.9023
23	6	719	  4.2129
24	6	772	  4.5234
25	6	822	  4.8164
26	6	873	  5.1152
27	6	910	  5.3320
28	6	948	  5.5547
29	2	0       0
30	4	0       0
31	6	0       0
32  8   0       0];%%add

I_MCS_Table2=[0	2	120	0.2344
1	2	193	0.3770
2	2	308	0.6016
3	2	449	0.8770
4	2	602	1.1758
5	4	378	1.4766
6	4	434	1.6953
7	4	490	1.9141
8	4	553	2.1602
9	4	616	2.4063
10	4	658	2.5703
11	6	466	2.7305
12	6	517	3.0293
13	6	567	3.3223
14	6	616	3.6094
15	6	666	3.9023
16	6	719	4.2129
17	6	772	4.5234
18	6	822	4.8164
19	6	873	5.1152
20	8	682.5	5.3320
21	8	711	5.5547
22	8	754	5.8906
23	8	797	6.2266
24	8	841	6.5703
25	8	885	6.9141
26	8	916.5	7.1602
27	8	948	7.4063
28	2	0     0
29	4	0     0
30	6	0     0
31	8	0     0];

I_MCS_Table3=[0	2	30	0.0586
1	2	40	0.3770
2	2	50	0.6016
3	2	64	0.8770
4	2	78	1.1758
5	2	99	1.4766
6	2	120	1.6953
7	2	157	1.9141
8	2	193	2.1602
9	2	251	2.4063
10	2	308	2.5703
11	2	379	2.7305
12	2	449	3.0293
13	2	526	3.3223
14	2	602	3.6094
15	4	340	3.9023
16	4	378	4.2129
17	4	434	4.5234
18	4	490	4.8164
19	4	553	5.1152
20	4	616	5.3320
21	6	438	5.5547
22	6	466	5.8906
23	6	517	6.2266
24	6	567	6.5703
25	6	616	6.9141
26	6	666	7.1602
27	6	719	7.4063
28	6	772     0
29	2	0     0
30	4	0     0
31	6	0     0];

if(PDSCH_Config==1)
    MCS_Table_PDSCH = 2;
elseif(PDSCH_Config==2)
    MCS_Table_PDSCH = 3;
else
    MCS_Table_PDSCH = 1;
end

if MCS_Table_PDSCH==1
    for i=1:length(I_MCS)
        Qm(i)=I_MCS_Table1(I_MCS(i)+1,2);
        R(i)=I_MCS_Table1(I_MCS(i)+1,3);
        R(i)=R(i)/1024;
        SE(i)=I_MCS_Table1(I_MCS(i)+1,4);
    end
else if(MCS_Table_PDSCH==2)
        for i=1:length(I_MCS)
            Qm(i)=I_MCS_Table2(I_MCS(i)+1,2);
            R(i)=I_MCS_Table2(I_MCS(i)+1,3);
            R(i)=R(i)/1024;
            SE(i)=I_MCS_Table2(I_MCS(i)+1,4);
        end
    else
        for i=1:length(I_MCS)
            Qm(i)=I_MCS_Table3(I_MCS(i)+1,2);
            R(i)=I_MCS_Table3(I_MCS(i)+1,3);
            R(i)=R(i)/1024;
            SE(i)=I_MCS_Table3(I_MCS(i)+1,4);
        end
    end
end
